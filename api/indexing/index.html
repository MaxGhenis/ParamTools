<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Extend with Indexing - ParamTools Docs</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">ParamTools Docs</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">Home</a>
                            </li>
                            <li >
                                <a href="../../parameters/">Parameters</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../guide/">Guide</a>
</li>
                                    
<li >
    <a href="../extend/">Extend</a>
</li>
                                    
<li class="active">
    <a href="./">Extend with Indexing</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../extend/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="disabled">
                                <a rel="prev" >
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#extend-with-indexing">Extend with Indexing</a></li>
            <li><a href="#example">Example</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="extend-with-indexing">Extend with Indexing</h1>
<p>ParamTools provides out-of-the-box parameter indexing. This is helpful for projects that have parameters that change at some rate over time. For example, tax parameters like the standard deduction are often indexed to price inflation. So, the value of the standard deduction actually increases every year by 1 or 2% depending on that year's inflation rate.</p>
<p>The <a href="/api/extend/">extend documentation</a> may be useful for gaining a better understanding of how ParamTools extends parameter values along <code>label_to_extend</code>.</p>
<p>To use the indexing feature:</p>
<ul>
<li>Set the <code>label_to_extend</code> class attribute to the label that should be extended</li>
<li>Set the <code>indexing_rates</code> class attribute to a dictionary of inflation rates where the keys correspond to the value of <code>label_to_extend</code> and the values are the indexing rates.</li>
<li>Set the <code>uses_extend_func</code> class attribute to <code>True</code>.</li>
<li>In <code>defaults</code> or <code>defaults.json</code>, set <code>indexed</code> to <code>True</code> for each parameter that needs to be indexed.</li>
</ul>
<h2 id="example">Example</h2>
<p>This is a continuation of the tax parameters example from the <a href="/api/extend/">extend documentation</a>. The differences are <code>indexed</code> is set to <code>True</code> for the <code>standard_deducation</code> parameter, <code>uses_extend_func</code> is set to <code>True</code>, and <code>index_rates</code> is specified with inflation rates obtained from the open-source tax modeling package, <a href="https://github.com/PSLmodels/Tax-Calculator/">Tax-Calculator</a>, using version 2.5.0.</p>
<pre><code class="python">import paramtools


class TaxParams(paramtools.Parameters):
    defaults = {
        &quot;schema&quot;: {
            &quot;labels&quot;: {
                &quot;year&quot;: {
                    &quot;type&quot;: &quot;int&quot;,
                    &quot;validators&quot;: {&quot;range&quot;: {&quot;min&quot;: 2013, &quot;max&quot;: 2027}}
                },
                &quot;marital_status&quot;: {
                    &quot;type&quot;: &quot;str&quot;,
                    &quot;validators&quot;: {&quot;choice&quot;: {&quot;choices&quot;: [&quot;single&quot;, &quot;joint&quot;]}}
                },
            }
        },
        &quot;standard_deduction&quot;: {
            &quot;title&quot;: &quot;Standard deduction amount&quot;,
            &quot;description&quot;: &quot;Amount filing unit can use as a standard deduction.&quot;,
            &quot;type&quot;: &quot;float&quot;,

            # Set indexed to True to extend standard_deduction with the built-in
            # extension logic.
            &quot;indexed&quot;: True,

            &quot;value&quot;: [
                {&quot;year&quot;: 2017, &quot;marital_status&quot;: &quot;single&quot;, &quot;value&quot;: 6350},
                {&quot;year&quot;: 2017, &quot;marital_status&quot;: &quot;joint&quot;, &quot;value&quot;: 12700},
                {&quot;year&quot;: 2018, &quot;marital_status&quot;: &quot;single&quot;, &quot;value&quot;: 12000},
                {&quot;year&quot;: 2018, &quot;marital_status&quot;: &quot;joint&quot;, &quot;value&quot;: 24000},
                {&quot;year&quot;: 2026, &quot;marital_status&quot;: &quot;single&quot;, &quot;value&quot;: 7685},
                {&quot;year&quot;: 2026, &quot;marital_status&quot;: &quot;joint&quot;, &quot;value&quot;: 15369}],
            &quot;validators&quot;: {
                &quot;range&quot;: {
                    &quot;min&quot;: 0,
                    &quot;max&quot;: 9e+99
                }
            }
        },
    }
    array_first = True
    label_to_extend = &quot;year&quot;
    # Activate use of extend_func method.
    uses_extend_func = True
    # inflation rates from Tax-Calculator v2.5.0
    index_rates = {
        2013: 0.0148,
        2014: 0.0159,
        2015: 0.0012,
        2016: 0.0127,
        2017: 0.0187,
        2018: 0.0224,
        2019: 0.0186,
        2020: 0.0233,
        2021: 0.0229,
        2022: 0.0228,
        2023: 0.0221,
        2024: 0.0211,
        2025: 0.0209,
        2026: 0.0211,
        2027: 0.0208,
        2028: 0.021,
        2029: 0.021
    }


params = TaxParams()
params.standard_deduction

# output:
# array([[ 6074.92, 12149.84],
#        [ 6164.83, 12329.66],
#        [ 6262.85, 12525.7 ],
#        [ 6270.37, 12540.73],
#        [ 6350.  , 12700.  ],
#        [12000.  , 24000.  ],
#        [12268.8 , 24537.6 ],
#        [12497.  , 24994.  ],
#        [12788.18, 25576.36],
#        [13081.03, 26162.06],
#        [13379.28, 26758.55],
#        [13674.96, 27349.91],
#        [13963.5 , 27926.99],
#        [ 7685.  , 15369.  ],
#        [ 7847.15, 15693.29]])
</code></pre>

<p>Adjustments are also indexed. In the example below, <code>standard_deduction</code> is set to 10,000 in 2017, increased to 15,000 for single tax units in 2020, and increased to 20,000 for joint tax units in 2021:</p>
<pre><code class="python">params.adjust(
    {
        &quot;standard_deduction&quot;: [
            {&quot;year&quot;: 2017, &quot;value&quot;: 10000},
            {&quot;year&quot;: 2020, &quot;marital_status&quot;: &quot;single&quot;, &quot;value&quot;: 15000},
            {&quot;year&quot;: 2021, &quot;marital_status&quot;: &quot;joint&quot;, &quot;value&quot;: 20000}
        ]
    }
)

params.standard_deduction

# output:
# array([[ 6074.92, 12149.84],
#        [ 6164.83, 12329.66],
#        [ 6262.85, 12525.7 ],
#        [ 6270.37, 12540.73],
#        [10000.  , 10000.  ],
#        [10187.  , 10187.  ],
#        [10415.19, 10415.19],
#        [15000.  , 10608.91],
#        [15349.5 , 20000.  ],
#        [15701.  , 20458.  ],
#        [16058.98, 20924.44],
#        [16413.88, 21386.87],
#        [16760.21, 21838.13],
#        [17110.5 , 22294.55],
#        [17471.53, 22764.97]])

</code></pre>

<h3 id="code-for-getting-tax-calculator-index-rates">Code for getting Tax-Calculator index rates</h3>
<pre><code class="python">import taxcalc
pol = taxcalc.Policy()
index_rates = {
    year: value
    for year, value in zip(list(range(2013, 2029 + 1)), pol.inflation_rates())
}

</code></pre>

<p>Note that there are some subtle details that are implemented in Tax-Calculator's indexing logic that are not implemented in this example. Tax-Calculator has a parameter called <code>CPI_offset</code> that adjusts inflation rates up or down by a fixed amount. The <code>indexed</code> property can also be turned on and off for each parameter. Implementing these nuanced features is left as the proverbial "trivial exercise to the reader."</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
